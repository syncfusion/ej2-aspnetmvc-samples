@using Syncfusion.EJ2;

@section ActionDescription{
    This sample demonstrates how to Lock and Unlock spreadsheets using XlsIO.
}
@section Meta{
    <meta name="description" content="This sample demonstrates how to protect Excel worksheet in ASP.NET MVC using Syncfusion XlsIO (Excel) library." />
}
@section Description{
    Microsoft Excel offers a special way for protecting specific data and certain worksheets with or without a password. This prevents anyone from changing, moving, or deleting important data.
    <br />
    <br />Excel allows you to edit or lock a range of cells in a protected worksheet by using the <b>Protection</b> tab in the <b>Format Cells </b>dialog. By default, all cells are locked, but they are not hidden when the worksheet is protected. Worksheets can be protected by choosing the <b>Tools - Protection - Protect Sheet</b> option in Excel.
    <br />
}
@section ControlsSection{
    <div class="control-section">
        <h5>
            Click the button to view an Excel spreadsheet generated by Essential XlsIO. Please
            note that Microsoft Excel Viewer or Microsoft Excel is required to view the resultant document.
        </h5>
        <br />
        <h5>  Save As :</h5>
        <div class="celldiv">
            <table>
                <tr>
                    <td>
                        @Html.EJS().RadioButton("radio1").Label("XLS").Name("select").Value("xls").Checked(false).Render()
                    </td>
                    <td>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    </td>
                    <td>
                        @Html.EJS().RadioButton("radio2").Label("XLSX").Name("select").Value("xlsx").Checked(true).Render()
                    </td>
                </tr>
            </table>
        </div>
        <br />
        <div class="celldiv">
            @Html.EJS().Button("lockbtn").Content("Lock Worksheet").Render()
            @Html.EJS().Button("unlockbtn").Content("Unlock Worksheet").Render()
        </div>
    </div>
    <script>
        document.getElementById('lockbtn').onclick = function () {
        if (document.getElementById('radio1').checked == true)
            location.href = '@Html.Raw(@Url.Action("WorksheetProtection", new { button= "Lock Worksheet", SaveOption = "Xls" }))';
        else
            location.href = '@Html.Raw(@Url.Action("WorksheetProtection", new { button = "Lock Worksheet", SaveOption = "Xlsx" }))';
        };
        document.getElementById('unlockbtn').onclick = function () {
        if (document.getElementById('radio1').checked == true)
            location.href = '@Html.Raw(@Url.Action("WorksheetProtection", new { button = "Unlock Worksheet", SaveOption = "Xls" }))';
        else
            location.href = '@Html.Raw(@Url.Action("WorksheetProtection", new { button = "Unlock Worksheet", SaveOption = "Xlsx" }))';
        };
    </script>
}
