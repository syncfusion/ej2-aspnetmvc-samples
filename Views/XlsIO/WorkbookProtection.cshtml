@using Syncfusion.EJ2;

@section ActionDescription{
    This sample demonstrates how to set protection for a workbook using XlsIO.
}
@section Meta{
    <meta name="description" content="This sample demonstrates how to protect Excel workbook in ASP.NET MVC using Syncfusion XlsIO (Excel) library." />
}
@section Description{
    You can lock the structure of a workbook, which prevents users from adding or deleting worksheets or from displaying hidden worksheets. You can also prevent users from changing the size or position of worksheet windows. Workbook structure and window protection apply to the entire workbook.
    <br />
    <br />
    <b>Features:</b>
    <br />
    <br />
    <ul>
        <li>Protecting a workbook with a password</li>
        <li>Protecting a window or structure from modification</li>
        <li>Removing protection of a workbook with a password</li>
    </ul>
    <br />
    To protect a workbook, point to <b>Protection</b> on the <b>Tools</b> menu, and then click <b>Protect Workbook</b>. You can choose which elements you want to protect (workbook structure, windows, or both) by selecting or clearing the corresponding check boxes.
    <br />
}
@section ControlsSection{
    <div class="control-section">
        <h5>
            Click the button to view an Excel spreadsheet generated by Essential XlsIO. Please
            note that Microsoft Excel Viewer or Microsoft Excel is required to view the resultant document.
        </h5>
        <br />
        <h5>  Save As :</h5>
        <div class="celldiv">
            <table>
                <tr>
                    <td>
                        @Html.EJS().RadioButton("radio1").Label("XLS").Name("select").Value("xls").Checked(false).Render()
                    </td>
                    <td>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    </td>
                    <td>
                        @Html.EJS().RadioButton("radio2").Label("XLSX").Name("select").Value("xlsx").Checked(true).Render()
                    </td>
                </tr>
            </table>
        </div>
        <br />
        <div class="celldiv">
            @Html.EJS().Button("protectbtn").Content("Protect Workbook").Render()
            @Html.EJS().Button("unprotectbtn").Content("Unprotect Workbook").Render()
        </div>
    </div>
    <script>
        document.getElementById('protectbtn').onclick = function () {
        if (document.getElementById('radio1').checked == true)
            location.href = '@Html.Raw(@Url.Action("WorkbookProtection", new { button= "Protect Workbook", SaveOption = "Xls" }))';
        else
            location.href = '@Html.Raw(@Url.Action("WorkbookProtection", new { button = "Protect Workbook", SaveOption = "xlsx" }))';
        };
        document.getElementById('unprotectbtn').onclick = function () {
        if (document.getElementById('radio1').checked == true)
            location.href = '@Html.Raw(@Url.Action("WorkbookProtection", new { button = "Unprotect Workbook", SaveOption = "Xls" }))';
        else
            location.href = '@Html.Raw(@Url.Action("WorkbookProtection", new { button = "Unprotect Workbook", SaveOption = "xlsx" }))';
        };
    </script>
}
