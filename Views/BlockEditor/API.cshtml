@using Syncfusion.EJ2
@using Syncfusion.EJ2.BlockEditor


@section ControlsSection{
    <div class="col-lg-8 control-section">
        <div class="blockeditor-api">
            @Html.EJS().BlockEditor("api-blockeditor").Created("onCreated").Blocks((List<EJ2MVCSampleBrowser.Models.BlockData.BlockModel>)ViewData["BlockDataAPI"]).Height("600px").Focus("onFocus").Render()
        </div>
    </div>
    <div class="col-lg-4 property-section">
        <div id="property" title="Properties">
            <table id="property" title="Properties">
                <tbody>
                    <tr>
                        <td>
                            <div>ReadOnly </div>
                        </td>
                        <td>
                            <div style="padding-top: 0;padding-left: 0;">
                                @Html.EJS().CheckBox("readonly").Change("readOnlyChange").Checked(false).Render()
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <div>Drag and Drop </div>
                        </td>
                        <td>
                            <div style="padding-top: 0;padding-left: 0;">
                                @Html.EJS().CheckBox("enableDragDrop").Change("EnableDragDropChange").Checked(true).Render()
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <div>Get Data</div>
                        </td>
                        <td>
                            <div class='e-btn-group' style="padding: 0; margin: 10px 0 0 10px;">
                                @Html.EJS().Button("getJson").Content("JSON").CssClass("e-btn").Render()
                                @Html.EJS().Button("getHtml").Content("HTML").CssClass("e-btn").Render()
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>
                            <div>
                                <button id="getBlockCount" class="btn btn-default">Get Block Count</button>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>
                            <div>
                                <button id="selectall" class="btn btn-default">Select All Blocks</button>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>
                            <div>
                                <button id="print" class="btn btn-default">Print</button>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    @*custom code start*@
    <style>
        .blockeditor-api {
            width: 100%;
            margin: 0 auto;
        }
        .property-section .e-btn {
            background-color: white;
            color: black;
        }
    </style>
    @*custom code end*@
}

@section PreScripts {
    <script>
        var blockEditorObj;
        var focusedBlock;

        // Helper: escape HTML to display raw content safely inside dialog
        var escapeHtml = function (html) {
            return html
                .replace(/&/g, '&amp;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;')
                .replace(/"/g, '&quot;')
                .replace(/'/g, '&#39;');
        };

        // Reusable predefined dialog helper (single place to show alerts)
        var openDialog = function (title, content, isHtml) {
            var updatedContent = isHtml ? escapeHtml(content) : content;
            var dlg = ej.popups.DialogUtility.alert({
                title: title,
                content: `<pre style="white-space: pre-wrap;">${updatedContent}</pre>`,
                okButton: { text: 'OK', click: function () { dlg.close(); } },
                isModal: true,
                position: { X: 'center', Y: 'center' },
                height: "400px",
                width: "500px",
                closeOnEscape: true
            });
        };

        function onCreated() {
            blockEditorObj = ej.base.getInstance(document.getElementById('api-blockeditor'), ejs.blockeditor.BlockEditor);
        }

        function onFocus(args) {
            focusedBlock = args.blockId;
        }

        function readOnlyChange(args) {
            blockEditorObj.readOnly = args.checked;
        }

        function EnableDragDropChange(args) {
            blockEditorObj.enableDragAndDrop = args.checked;
        }

        // Sample action: get editor data as JSON and show it in a predefined dialog (pretty-printed)
        document.getElementById('getJson').onclick = function () {
            var jsonData = blockEditorObj.getDataAsJson();
            openDialog('JSON Data', JSON.stringify(jsonData, null, 2));
        };

        // Sample action: get editor HTML and show it as escaped text using the same dialog helper
        document.getElementById('getHtml').onclick = function () {
            var htmlData = blockEditorObj.getDataAsHtml();
            openDialog('Editor HTML', htmlData, true);
        };

        // Sample action: show a compact predefined dialog with the total block count
        document.getElementById('getBlockCount').onclick = function () {
            var dialog = ej.popups.DialogUtility.alert({
                title: "Block Count",
                content: '<div>Total blocks: <b>' + blockEditorObj.getBlockCount() + '</b></div>',
                okButton: { text: 'OK', click: function () { dialog.close(); } },
                isModal: true,
                position: { X: 'center', Y: 'center' },
                width: "250px",
                closeOnEscape: true
            });
        };

        // Sample action: invoke core API to select all blocks from the property panel
        document.getElementById('selectall').onclick = function () {
            blockEditorObj.selectAllBlocks();
        };

        // Sample action: print the editor content via the built-in API
        document.getElementById('print').onclick = function () {
            blockEditorObj.print();
        };
    </script>
}

@section Meta {
    <meta name="description" content="This example demonstrates the API's' in ASP.NET Core Block Editor control. Explore here for more details." />
}

@section ActionDescription {
    <div id="action-description">
        <p>This sample demonstrates the usage of API in Block Editor. Use the properties panel to change read-only mode, enable/disable drag and drop, get JSON data, get HTML data, get block count and select all blocks</p>
    </div>
}

@section Description {
    <div id="description">
        <p>In this demo, you can explore the API behaviors by:</p>
        <ul>
            <li>Click the <code>readOnly</code> checkbox to enable/disable editable and non-editable mode of the Block Editor.</li>
            <li>Click the <code>enableDragDrop</code> checkbox to enable/disable drag and drop functionality.</li>
            <li>
                Use the grouped buttons:
                <ul>
                    <li><code>JSON</code>: Shows the editor’s data as JSON in a predefined dialog.</li>
                    <li><code>HTML</code>: Shows the editor’s HTML output as text in a predefined dialog.</li>
                </ul>
            </li>
            <li>Click the <code>getBlockCount</code> button to display the total number of blocks in an predefined dialog.</li>
            <li>Click the <code>selectAllBlocks</code> button to select all content in the editor.</li>
            <li>Click the <code>print</code> button to preview the content before printing from the editor.</li>
        </ul>
    </div>
}
@section Title{
    <title>ASP.NET MVC BlockEditor API's Example - Syncfusion Demos </title>
}
@section Header{
    <h1 class='sb-sample-text'>Example of API's in ASP.NET MVC BlockEditor Control</h1>
}