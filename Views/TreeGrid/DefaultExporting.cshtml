@using Syncfusion.EJ2
@using Syncfusion.EJ2.Grids

@*custom code start*@

@{
    ViewBag.Title = "Exporting";
}
@*custom code end*@

@section ControlsSection{
    <div class="control-section">
        @(Html.EJS().TreeGrid("Exporting")
            .AllowExcelExport()
            .AllowPdfExport()
            .Height(400)
            .DataSource((IEnumerable<object>)ViewBag.datasource)
            .Toolbar(new List<string> { "ExcelExport" , "CsvExport", "PdfExport" })
            .Columns(col =>
            {
                col.Field("TaskId").HeaderText("Task ID").Width(70).TextAlign(TextAlign.Right).Add();
                col.Field("TaskName").HeaderText("Task Name").Width(200).Add();
                col.Field("StartDate").HeaderText("Start Date").Format("yMd").TextAlign(TextAlign.Right).Width(90).Add();
                col.Field("EndDate").HeaderText("End Date").Format("yMd").TextAlign(TextAlign.Right).Width(90).Add();
                col.Field("Duration").HeaderText("Duration").Width(80).TextAlign(TextAlign.Right).Add();
                col.Field("Progress").HeaderText("Progress").Width(80).TextAlign(TextAlign.Right).Add();
                col.Field("Priority").HeaderText("Priority").Width(90).Add();
            })
            .ToolbarClick("onToolbarClick")
            .ChildMapping("Children")
            .TreeColumnIndex(1)
            .Render()
        )
    </div>
    <script>
        function onToolbarClick(args) {
            if (args.item.text === 'Excel Export') {
                this.excelExport();
            } else if (args.item.text === 'PDF Export') {
                this.pdfExport();
            } else if (args.item.text === 'CSV Export') {
                this.csvExport();
            }
        }
    </script>
}

@*custom code start*@

@section Meta{
                    <meta name="description" content="This example demonstrates the Default Exporting in ASP.NET MVC Tree Grid control. Explore here for more details."/>
                }


@section ActionDescription{
    <div id="action-description">
        <p>This sample demonstrates the client-side exporting of the Tree Grid, which allows you to export its data to the Excel, Pdf and CSV formats. Use the toolbar buttons to export TreeGrid data to desired format.</p>
    </div>
}

@section Description{
    <div id="description">
        <p>
           Tree Grid supports client-side exporting which allows you to export its data to the Excel, Pdf and CSV formats. 
        </p>
        <p>
            In this demo, for the toolbar items of exporting, we have defined actions in <code>ToolbarClick</code> event to export the Tree Grid data using the <code>excelExport</code>, <code>pdfExport</code> and <code>csvExport</code> methods
        </p>
        <p>More information about Exporting can be found in this documentation section.
        </p>
    </div>
}

@*custom code end*@
@section Title{
                    <title>ASP.NET MVC Tree Grid Default Exporting Example - Syncfusion Demos </title> 
                }
@section Header{
                    <h1 class='sb-sample-text'>Example of Default Exporting in ASP.NET MVC Tree Grid Control</h1>
                }