@using Syncfusion.EJ2
@using Syncfusion.EJ2.Grids

@*custom code start*@

@{
    ViewBag.Title = "ServerSideExporting";
}

@*custom code end*@
@section ControlsSection{
    <div class="control-section">
        @Html.EJS().TreeGrid("ServerSideExporting").AllowExcelExport(true).AllowPdfExport(true).DataSource((IEnumerable<object>)ViewBag.datasource).ToolbarClick("toolbarClick").Columns(col =>
        {
        col.Field("TaskId").HeaderText("Task ID").Width(90).TextAlign(TextAlign.Right).Add();
        col.Field("TaskName").HeaderText("Task Name").Width(180).Add();
        col.Field("StartDate").HeaderText("Start Date").Format("yMd").TextAlign(TextAlign.Right).Width(120).Add();
        col.Field("EndDate").HeaderText("End Date").Format("yMd").TextAlign(TextAlign.Right).Width(120).Add();
        col.Field("Duration").HeaderText("Duration").Width(90).TextAlign(TextAlign.Right).Add();
        col.Field("Progress").HeaderText("Progress").Width(90).TextAlign(TextAlign.Right).Add();
        }).Height(400).ChildMapping("Children").TreeColumnIndex(1).Toolbar(new List<string>() { "ExcelExport", "PdfExport", "CsvExport" }).Render()
    </div>

    <script>
        function toolbarClick(args) {

            var gridObj = document.getElementById("ServerSideExporting").ej2_instances[0];
            if (args.item.text == "PDF Export") {
                gridObj.serverPdfExport("@Url.Action("PdfExport", "TreeGrid")");
            }
            if (args.item.text == "Excel Export") {
                gridObj.serverExcelExport("@Url.Action("ExcelExport", "TreeGrid")");
            }
            if (args.item.text == "CSV Export") {
                gridObj.serverCsvExport("@Url.Action("CsvExport", "TreeGrid")");
            }
        }
    </script>
}

@*custom code start*@

@section Meta{
    <meta name="description" content="This example demonstrates the Server Side Exporting in ASP.NET MVC Tree Grid control. Explore here for more details." />
}

@section ActionDescription{
    <div id="action-description">
        <p>
            This sample demonstrates the server-side exporting of the Tree Grid, which allows you to export its data to the Excel, CSV and PDF formats using server-side actions.
            Use the toolbar buttons to export Tree Grid data to desired format.
        </p>
    </div>
}

@section Description{
    <div id="description">
        <p> Server-side exporting is implemented by using the <a target="_blank" href="https://www.nuget.org/packages/Syncfusion.EJ2.GridExport.MVC5/">Syncfusion.EJ2.GridExport </a> library </p>
        <p>
            In this demo, ExcelExport, CsvExport and PdfExport items are defined in the toolbar and for these toolbar items, we have defined actions in 
                <a target="_blank"
                   href="https://help.syncfusion.com/cr/aspnetmvc-js2/syncfusion.ej2.treegrid.treegrid.html#Syncfusion_EJ2_TreeGrid_TreeGrid_ToolbarClick">
                    ToolbarClick
                </a> event to export the Grid data using the 
                <a target="_blank"
                   href="https://ej2.syncfusion.com/javascript/documentation/api/treegrid/#serverexcelexport">
                    serverExcelExport
                </a>
                <a target="_blank"
                   href="https://ej2.syncfusion.com/javascript/documentation/api/treegrid/#servercsvexport">
                    serverCsvExport
                </a> and 
                <a target="_blank"
                   href="https://ej2.syncfusion.com/javascript/documentation/api/treegrid/#serverpdfexport">
                    serverPdfExport
                </a> methods.
        </p>
    </div>
}

@*custom code end*@
@section Title{
    <title>ASP.NET MVC Tree Grid Server Side Exporting Example - Syncfusion Demos  </title>
}
@section Header{
    <h1 class='sb-sample-text'>ASP.NET MVC Tree Grid Server Side Exporting Example - Syncfusion Demos </h1>
}
